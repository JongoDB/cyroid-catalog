seed_id: incident-response-drill
name: Incident Response Drill
description: |
  Blue team exercise that plants indicators of compromise across systems.
  Participants must identify and document all planted artifacts within
  the time limit. Tests detection capabilities and IR procedures.
category: blue-team
difficulty: intermediate
duration_minutes: 30
required_roles:
  - domain-controller
  - workstation
  - webserver

events:
  - sequence: 1
    delay_minutes: 0
    title: "IOC - Malicious local admin account"
    description: "Backdoor admin account created on domain controller"
    target_role: domain-controller
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\ioc_admin_account.txt"
        content: |
          PLANTED IOC: Local admin account
          Account: backdoor_admin
          Created: During attack simulation

  - sequence: 2
    delay_minutes: 0
    title: "IOC - Suspicious scheduled task"
    description: "Malicious scheduled task on workstation"
    target_role: workstation
    actions:
      - type: create_scheduled_task
        name: "SystemHealthCheck"
        command: "C:\\Windows\\Temp\\beacon.exe"

  - sequence: 3
    delay_minutes: 0
    title: "IOC - Webshell in webserver"
    description: "PHP webshell planted in web root"
    target_role: webserver
    actions:
      - type: create_file
        path: "/var/www/html/admin/.config.php"
        content: "<?php /* PLANTED WEBSHELL - Find me! */ ?>"

  - sequence: 4
    delay_minutes: 0
    title: "IOC - Modified hosts file"
    description: "DNS poisoning via hosts file modification"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Windows\\System32\\drivers\\etc\\hosts.bak"
        content: |
          # PLANTED IOC - Modified hosts file
          10.0.0.99 login.microsoft.com
          10.0.0.99 update.windows.com

  - sequence: 5
    delay_minutes: 0
    title: "IOC - Suspicious PowerShell history"
    description: "Malicious PowerShell commands in history"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Users\\Public\\powershell_history.txt"
        content: |
          Invoke-Mimikatz -DumpCreds
          Invoke-BloodHound -CollectionMethod All
          New-PSSession -ComputerName DC01

  - sequence: 6
    delay_minutes: 0
    title: "IOC - Backdoor Domain Admins member"
    description: "Unauthorized user in Domain Admins group"
    target_role: domain-controller
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\ioc_domain_admin.txt"
        content: |
          PLANTED IOC: Unauthorized Domain Admin
          User: svc_backup (should not be admin)

  - sequence: 7
    delay_minutes: 0
    title: "IOC - Hidden file in System32"
    description: "Suspicious hidden executable in system directory"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Windows\\System32\\svchost32.exe"
        content: "PLANTED IOC - Suspicious executable"

  - sequence: 8
    delay_minutes: 0
    title: "IOC - Suspicious firewall rule"
    description: "Outbound firewall rule allowing suspicious traffic"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\ioc_firewall.txt"
        content: |
          PLANTED IOC: Suspicious firewall rule
          Rule: Allow_C2_Traffic
          Port: 4444 (Outbound)

  - sequence: 9
    delay_minutes: 0
    title: "IOC - Registry Run key persistence"
    description: "Malicious autorun registry entry"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\ioc_registry.txt"
        content: |
          PLANTED IOC: Registry Run key
          Path: HKCU\Software\Microsoft\Windows\CurrentVersion\Run
          Name: WindowsDefenderUpdate
          Value: C:\Windows\Temp\beacon.exe

  - sequence: 10
    delay_minutes: 0
    title: "IOC - Planted credentials file"
    description: "Credential dump file left on system"
    target_role: domain-controller
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\ntds_dump.txt"
        content: |
          PLANTED IOC - NTDS.dit dump
          Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0
          krbtgt:502:aad3b435b51404eeaad3b435b51404ee:b21c99fc068e3ab2ca789bccbef67de4
