seed_id: ransomware-attack
name: Ransomware Attack
description: |
  Simulates a ransomware attack starting from initial phishing payload
  through to file encryption and ransom note deployment. Covers initial
  access, persistence, discovery, credential access, lateral movement,
  and impact phases of the MITRE ATT&CK framework.
category: red-team
difficulty: intermediate
duration_minutes: 60
required_roles:
  - domain-controller
  - workstation
  - file-server

events:
  - sequence: 1
    delay_minutes: 0
    title: "Initial Access - Phishing payload executed"
    description: "User executes malicious email attachment on workstation"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Users\\Public\\invoice.exe"
        content: "Simulated malicious payload"

  - sequence: 2
    delay_minutes: 5
    title: "Persistence - Scheduled task created"
    description: "Malware establishes persistence via scheduled task"
    target_role: workstation
    actions:
      - type: create_scheduled_task
        name: "WindowsUpdate"
        command: "C:\\Users\\Public\\invoice.exe"

  - sequence: 3
    delay_minutes: 10
    title: "Discovery - Network enumeration"
    description: "Attacker enumerates network shares and systems"
    target_role: workstation
    actions:
      - type: execute_command
        command: "net view /domain"

  - sequence: 4
    delay_minutes: 15
    title: "Credential Access - LSASS memory dump"
    description: "Attacker attempts to dump credentials from memory"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\lsass.dmp"
        content: "Simulated credential dump"

  - sequence: 5
    delay_minutes: 20
    title: "Lateral Movement - Access file server"
    description: "Attacker moves laterally to file server using stolen credentials"
    target_role: file-server
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\beacon.exe"
        content: "Simulated lateral movement beacon"

  - sequence: 6
    delay_minutes: 30
    title: "Defense Evasion - Disable shadow copies"
    description: "Attacker disables Volume Shadow Copy service"
    target_role: file-server
    actions:
      - type: execute_command
        command: "vssadmin delete shadows /all /quiet"

  - sequence: 7
    delay_minutes: 45
    title: "Impact - File encryption simulation"
    description: "Ransomware encrypts files (simulation renames files)"
    target_role: file-server
    actions:
      - type: create_file
        path: "C:\\Users\\Public\\Documents\\important_file.txt.encrypted"
        content: "FILE ENCRYPTED BY RANSOMWARE"

  - sequence: 8
    delay_minutes: 50
    title: "Impact - Ransom note deployment"
    description: "Ransomware drops ransom note on all systems"
    target_role: file-server
    actions:
      - type: create_file
        path: "C:\\Users\\Public\\Desktop\\README_DECRYPT.txt"
        content: |
          YOUR FILES HAVE BEEN ENCRYPTED!
          To decrypt your files, send 5 BTC to: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa
          Contact: ransomware@example.com
