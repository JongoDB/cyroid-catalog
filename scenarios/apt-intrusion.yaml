seed_id: apt-intrusion
name: APT Intrusion
description: |
  Simulates an Advanced Persistent Threat (APT) intrusion from initial
  spearphishing through to data exfiltration. Covers the full kill chain
  including C2 establishment, Active Directory reconnaissance, privilege
  escalation, and data staging.
category: red-team
difficulty: advanced
duration_minutes: 120
required_roles:
  - domain-controller
  - workstation
  - webserver

events:
  - sequence: 1
    delay_minutes: 0
    title: "Initial Access - Spearphishing payload"
    description: "Targeted phishing email delivers malicious document"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Users\\Public\\Documents\\Q4_Report.docm"
        content: "Simulated malicious macro document"

  - sequence: 2
    delay_minutes: 5
    title: "Command and Control - Beacon established"
    description: "Malware establishes C2 communication channel"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\svchost.exe"
        content: "Simulated C2 beacon"

  - sequence: 3
    delay_minutes: 15
    title: "Discovery - Local enumeration"
    description: "Attacker gathers local system information"
    target_role: workstation
    actions:
      - type: execute_command
        command: "systeminfo && whoami /all"

  - sequence: 4
    delay_minutes: 25
    title: "Discovery - AD enumeration"
    description: "Attacker performs Active Directory reconnaissance"
    target_role: workstation
    actions:
      - type: execute_command
        command: "net user /domain && net group /domain"

  - sequence: 5
    delay_minutes: 35
    title: "Credential Access - Kerberoasting"
    description: "Attacker requests service tickets for offline cracking"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Users\\Public\\krb5tgs.txt"
        content: "Simulated Kerberos tickets"

  - sequence: 6
    delay_minutes: 45
    title: "Credential Access - Credential harvesting"
    description: "Attacker harvests additional credentials"
    target_role: workstation
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\creds.txt"
        content: "Simulated harvested credentials"

  - sequence: 7
    delay_minutes: 55
    title: "Lateral Movement - Pivot to webserver"
    description: "Attacker moves to webserver using stolen credentials"
    target_role: webserver
    actions:
      - type: create_file
        path: "/tmp/.backdoor"
        content: "Simulated backdoor"

  - sequence: 8
    delay_minutes: 70
    title: "Persistence - Webshell deployed"
    description: "Attacker deploys webshell for persistent access"
    target_role: webserver
    actions:
      - type: create_file
        path: "/var/www/html/uploads/.shell.php"
        content: "<?php /* Simulated webshell */ ?>"

  - sequence: 9
    delay_minutes: 85
    title: "Privilege Escalation - Domain admin access"
    description: "Attacker escalates to domain administrator"
    target_role: domain-controller
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\admin_token.txt"
        content: "Simulated admin token"

  - sequence: 10
    delay_minutes: 95
    title: "Collection - Data staging"
    description: "Attacker stages sensitive data for exfiltration"
    target_role: domain-controller
    actions:
      - type: create_file
        path: "C:\\Windows\\Temp\\staged_data.zip"
        content: "Simulated staged data"

  - sequence: 11
    delay_minutes: 105
    title: "Exfiltration - Data exfiltration"
    description: "Attacker exfiltrates staged data via HTTPS"
    target_role: workstation
    actions:
      - type: execute_command
        command: "echo Simulating data exfiltration to C2"

  - sequence: 12
    delay_minutes: 115
    title: "Defense Evasion - Cover tracks"
    description: "Attacker clears logs and removes artifacts"
    target_role: domain-controller
    actions:
      - type: execute_command
        command: "wevtutil cl Security"
